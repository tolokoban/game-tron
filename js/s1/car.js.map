{"version":3,"sources":["car.js"],"names":["require","module","exports","_","MINUS_ONE","DIRECTIONS","RIGHT","LEFT","DEFAULT_X","DEFAULT_Y","Car","action","x","y","dir","walls","minSpeed","speed","maxSpeed","break","lastTime","time","delta","Math","max","actionRight","addSegmentToWalls","length","actionLeft","actionAccel","x0","y0","dirV","x1","y1","unshift"],"mappings":";;;;;;;;;;;;;;;;AAAA;AAAqBA,OAAO,CAAE,QAAF,EAAY,UAASA,OAAT,EAAkBC,MAAlB,EAA0BC,OAA1B,EAAmC;AAAE,MAAIC,CAAC,GAAC,SAAFA,CAAE,GAAU;AAAC,WAAO,EAAP;AAAU,GAA3B;;AAA+B;;AAE5G,MAAMC,SAAS,GAAG,CAAC,CAAnB;AACA,MAAMC,UAAU,GAAG,CAAE,CAAC,CAAD,EAAID,SAAJ,CAAF,EAAkB,CAAC,CAAD,EAAI,CAAJ,CAAlB,EAA0B,CAAC,CAAD,EAAI,CAAJ,CAA1B,EAAkC,CAACA,SAAD,EAAY,CAAZ,CAAlC,CAAnB;AACA,MAAME,KAAK,GAAG,CAAd;AACA,MAAMC,IAAI,GAAG,CAAb;AACA,MAAMC,SAAS,GAAG,CAAlB;AACA,MAAMC,SAAS,GAAG,GAAlB;;AAP2E,MASrEC,GATqE;AAAA;AAAA;AAUvE,iBAAaC,MAAb,EAAiE;AAAA,UAA5CC,CAA4C,uEAAxCJ,SAAwC;AAAA,UAA7BK,CAA6B,uEAAzBJ,SAAyB;AAAA,UAAdK,GAAc,uEAARR,KAAQ;;AAAA;;AAC7D,WAAKK,MAAL,GAAcA,MAAd;AACA,WAAKI,KAAL,GAAa,CAACH,CAAD,EAAIC,CAAJ,EAAOD,CAAP,EAAUC,CAAV,CAAb;AACA,WAAKG,QAAL,GAAgB,KAAhB;AACA,WAAKC,KAAL,GAAa,KAAKD,QAAlB;AACA,WAAKE,QAAL,GAAgB,KAAhB;AACA,WAAKC,KAAL,GAAa,MAAb;AACA,WAAKC,QAAL,GAAgB,CAAhB;AACA,WAAKN,GAAL,GAAWA,GAAX;AACH;;AAnBsE;AAAA;AAAA,2BAqBjEO,IArBiE,EAqB1D;AACT,YAAI,KAAKD,QAAL,KAAkB,CAAtB,EAA0B;AACtB,eAAKA,QAAL,GAAgBC,IAAhB;AACA;AACH;;AAED,YAAMC,KAAK,GAAGD,IAAI,GAAG,KAAKD,QAA1B;AACA,aAAKA,QAAL,GAAgBC,IAAhB,CAPS,CAST;AACA;;AACA,YAAI,KAAKJ,KAAL,GAAa,KAAKD,QAAtB,EAAiC;AAC7B,eAAKC,KAAL,GAAaM,IAAI,CAACC,GAAL,CAAU,KAAKR,QAAf,EAAyB,KAAKC,KAAL,GAAa,KAAKE,KAAL,GAAaG,KAAnD,CAAb;AACH,SAbQ,CAeT;AACA;;;AACA,YAAMX,MAAM,GAAG,KAAKA,MAApB;;AACA,YAAIA,MAAM,CAACc,WAAX,EAAyB;AACrB,eAAKC,iBAAL;AACA,eAAKZ,GAAL,GAAW,CAAC,KAAKA,GAAL,GAAWR,KAAZ,IAAqBD,UAAU,CAACsB,MAA3C;AACH,SAHD,MAGO,IAAIhB,MAAM,CAACiB,UAAX,EAAwB;AAC3B,eAAKF,iBAAL;AACA,eAAKZ,GAAL,GAAW,CAAC,KAAKA,GAAL,GAAWP,IAAZ,IAAoBF,UAAU,CAACsB,MAA1C;AACH;;AACD,YAAIhB,MAAM,CAACkB,WAAX,EAAyB;AACrB,eAAKZ,KAAL,GAAa,KAAKC,QAAlB;AACH,SA3BQ,CA6BT;AACA;;;AACA,YAAMY,EAAE,GAAG,KAAKf,KAAL,CAAW,CAAX,CAAX;AAAA,YACMgB,EAAE,GAAG,KAAKhB,KAAL,CAAW,CAAX,CADX;AAAA,YAEMiB,IAAI,GAAG3B,UAAU,CAAC,KAAKS,GAAN,CAFvB;AAAA,YAGMmB,EAAE,GAAGH,EAAE,GAAG,KAAKb,KAAL,GAAaK,KAAb,GAAqBU,IAAI,CAAC,CAAD,CAHzC;AAAA,YAIME,EAAE,GAAGH,EAAE,GAAG,KAAKd,KAAL,GAAaK,KAAb,GAAqBU,IAAI,CAAC,CAAD,CAJzC;AAKA,aAAKpB,CAAL,GAASqB,EAAT;AACA,aAAKpB,CAAL,GAASqB,EAAT;AACA,aAAKnB,KAAL,CAAW,CAAX,IAAgBkB,EAAhB;AACA,aAAKlB,KAAL,CAAW,CAAX,IAAgBmB,EAAhB;AACH;AA7DsE;AAAA;AAAA,0CA+DnD;AAAA,yCACD,KAAKnB,KADJ;AAAA,YACTH,CADS;AAAA,YACNC,CADM;;AAEhB,aAAKE,KAAL,CAAWoB,OAAX,CAAoBvB,CAApB,EAAuBC,CAAvB;AACH;AAlEsE;;AAAA;AAAA;;AAsE3EZ,EAAAA,MAAM,CAACC,OAAP,GAAiBQ,GAAjB;AAIAT,EAAAA,MAAM,CAACC,OAAP,CAAeC,CAAf,GAAmBA,CAAnB;AACC,CA3E2B,CAAP","sourcesContent":["/** @module s1/car */require( 's1/car', function(require, module, exports) { var _=function(){return ''};   \"use strict\";\r\n\r\nconst MINUS_ONE = -1;\r\nconst DIRECTIONS = [ [0, MINUS_ONE], [1, 0], [0, 1], [MINUS_ONE, 0] ];\r\nconst RIGHT = 1;\r\nconst LEFT = 3;\r\nconst DEFAULT_X = 0;\r\nconst DEFAULT_Y = 256;\r\n\r\nclass Car {\r\n    constructor( action, x = DEFAULT_X, y = DEFAULT_Y, dir = RIGHT ) {\r\n        this.action = action;\r\n        this.walls = [x, y, x, y];\r\n        this.minSpeed = 0.050;\r\n        this.speed = this.minSpeed;\r\n        this.maxSpeed = 0.250;\r\n        this.break = 0.0005;\r\n        this.lastTime = 0;\r\n        this.dir = dir;\r\n    }\r\n\r\n    move( time ) {\r\n        if( this.lastTime === 0 ) {\r\n            this.lastTime = time;\r\n            return;\r\n        }\r\n\r\n        const delta = time - this.lastTime;\r\n        this.lastTime = time;\r\n\r\n        // -------------\r\n        // Décelération.\r\n        if( this.speed > this.minSpeed ) {\r\n            this.speed = Math.max( this.minSpeed, this.speed - this.break * delta );\r\n        }\r\n\r\n        // --------------------\r\n        // Gestion des touches.\r\n        const action = this.action;\r\n        if( action.actionRight ) {\r\n            this.addSegmentToWalls();\r\n            this.dir = (this.dir + RIGHT) % DIRECTIONS.length;\r\n        } else if( action.actionLeft ) {\r\n            this.addSegmentToWalls();\r\n            this.dir = (this.dir + LEFT) % DIRECTIONS.length;\r\n        }\r\n        if( action.actionAccel ) {\r\n            this.speed = this.maxSpeed;\r\n        }\r\n\r\n        // ---------------------------------\r\n        // Déplacement en fonction du temps.\r\n        const x0 = this.walls[0],\r\n              y0 = this.walls[1],\r\n              dirV = DIRECTIONS[this.dir],\r\n              x1 = x0 + this.speed * delta * dirV[0],\r\n              y1 = y0 + this.speed * delta * dirV[1];\r\n        this.x = x1;\r\n        this.y = y1;\r\n        this.walls[0] = x1;\r\n        this.walls[1] = y1;\r\n    }\r\n\r\n    addSegmentToWalls() {\r\n        const [x, y] = this.walls;\r\n        this.walls.unshift( x, y );        \r\n    }\r\n}\r\n\r\n\r\nmodule.exports = Car;\r\n\r\n\r\n\r\nmodule.exports._ = _;\n})"]}