"use strict";function addListener(t,e){window.addEventListener?window.addEventListener(t,e,!1):window.attachEvent("on"+t,e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n,r=0;r<e.length;r++)n=e[r],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){const e="node://".length,n={},r={},i="function"==typeof window.require?window.require:null,o=function(a,s){if("node://"===a.substr(0,e)){if(!i)throw Error("[require] NodeJS is not available to load module "+a.substr(e));return i(a.substr(e))}if("function"==typeof s)return r[a]=s,s;const c=r[a];if(void 0===c){const u=new Error("Required module is missing: "+a);throw console.error(u.stack),u}var l=n[a];if(void 0===l){l={exports:{}};const h=l.exports;c.call(t,o,l,h),n[a]=l.exports,l=l.exports}return l};t.APP={},t.require=o}(this),addListener("DOMContentLoaded",function(){document.body.parentNode.$data={},APP=require("s5.app"),setTimeout(function(){"function"==typeof APP.start&&APP.start()})}),require("$",function(t,e,n){function r(t,e){var n=t;if(1<e.length){for(var r,i="",o=0,a=0;a<t.length;a++)if("$"===(r=t.charAt(a))){i+=t.substring(o,a),a++;var s=t.charCodeAt(a)-48;i+=0>s||s>=e.length?"$".concat(t.charAt(a)):e[s],o=a+1}else"\\"===r&&(i+=t.substring(o,a),a++,i+=t.charAt(a),o=a+1);i+=t.substr(o),n=i}return n}n.config={name:'"game-tron"',description:'"Step by step making-of tron like game."',author:'"tolokoban"',version:'"0.0.9"',major:"0",minor:"0",revision:"9",date:"2019-03-02T12:49:15.055Z",consts:{}},n.lang=function(t){var e=t;return void 0===e&&(window.localStorage&&(e=window.localStorage.getItem("Language")),!e&&!(e=window.navigator.language)&&!(e=window.navigator.browserLanguage)&&(e="fr"),e=e.substr(0,2).toLowerCase()),window.localStorage&&window.localStorage.setItem("Language",e),e},n.intl=function(t,e){var i=t[n.lang()],o=e[0],a=Object.keys(t)[0];if(!a)return o;if(!i&&!(i=t[a]))return o;var s=i[o];return s||(i=t[a],s=i[o]),s?r(s,e):o}}),require("s5.app",function(t,e,n){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:60,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:60,n=new s(-t/2,5-e/2);return n.move(0,e-11),n.add(),n.move(5,0),n.add(),n.move(0,5),n.add(),n.move(t-11,0),n.add(),n.move(0,-5),n.add(),n.move(5,0),n.add(),n.move(0,11-e),n.add(),n.move(-5,0),n.add(),n.move(0,-5),n.add(),n.move(11-t,0),n.add(),n.move(0,5),n.add(),n.move(-5,0),[n]}var i=t("dom"),o=t("s5.car"),a=t("s5.tron.action"),s=t("s5.polyline"),c=t("s5.painter.car-wall"),u=t("webgl.resize"),l=t("webgl.camera");n.start=function(){function t(e){window.requestAnimationFrame(t),E++,15<E&&(E=0,T.textContent="".concat(Math.floor(.5+16e3/(e-_))," FPS"),_=e),u(n,1)&&(s.aspect=n.drawingBufferWidth/n.drawingBufferHeight);var r=.35+.3*Math.abs(Math.cos(9e-5*e));s.orbit(h.polyline.lastX,h.polyline.lastY,0,50,r,1e-4*e),g.paint(s.matrix);for(var i,o=0;o<v.length;o++)i=v[o],i.isDead||i.painter.paint(s.matrix);for(var a,c=0;c<v.length;c++)if(a=v[c],!a.isDead){var l=a.polyline.lastX,f=a.polyline.lastY;a.move(e);for(var p,d=a.polyline.lastX,y=a.polyline.lastY,b=0;b<v.length;b++)if(p=v[b],!p.isDead&&p.polyline.collide(l,f,d,y)){a.isDead=!0,console.log("DEAD!");break}if(!a.isDead){var w=!0,A=!1,x=void 0;try{for(var P,C,S=m[Symbol.iterator]();!(w=(P=S.next()).done);w=!0)if(C=P.value,C.collide(l,f,d,y)){a.isDead=!0,console.log("DEAD in boundary!");break}}catch(t){A=!0,x=t}finally{try{w||null==S.return||S.return()}finally{if(A)throw x}}}}}var e=i("canvas"),n=e.getContext("webgl",{}),s=new l,h=new o({action:a.create({type:"keyboard"}),x:-25,y:0,dir:1,color:new Float32Array([1,1,0])}),f=new o({action:a.create({type:"ai",targets:[h]}),reaction:10,x:25,y:7,dir:3,color:new Float32Array([0,1,1])}),p=new o({action:a.create({type:"ai",targets:[h]}),reaction:20,x:0,y:-24,dir:2,color:new Float32Array([1,0,1])}),d=new o({action:a.create({type:"ai",targets:[h]}),reaction:30,x:6,y:-24,dir:0,color:new Float32Array([1,.5,.25])}),v=[h,f,p,d],m=r(),g=new c(n,m[0],new Float32Array([.3,.3,.3]));v.forEach(function(t){t.painter=new c(n,t.polyline,t.color)});for(var y,b=[f,p,d],w=0;w<b.length;w++)y=b[w],y.action.car=y,y.action.cars=v,y.action.boundaries=m;n.clearColor(.3,.3,.3,1);var _=0,E=0,T=document.getElementById("FPS");n.enable(n.DEPTH_TEST),n.depthFunc(n.LESS),window.requestAnimationFrame(t)},e.exports._=function(){return""}}),require("webgl.camera",function(t,e){function n(t,e,r){return"string"==typeof e?void("function"==typeof r?Object.defineProperty(t,e,{get:r,set:function(){throw Error('Property "'.concat(e,'" is read only!'))},configurable:!1,enumerable:!0}):Object.defineProperty(t,e,{value:r,writable:!1,configurable:!1,enumerable:!0})):void Object.keys(e).forEach(function(r){n(t,r,e[r])})}var r=t("webgl.math").m4,i=Math.PI/180,o=function(){function t(e){var o=this;_classCallCheck(this,t);var a=this,s=void 0===e?{}:e;void 0===s.angle&&(s.angle=35),void 0===s.aspect&&(s.aspect=1),void 0===s.near&&(s.near=.5),void 0===s.far&&(s.far=2e3),this._angle=s.angle,this._aspect=s.aspect,this._near=s.near,this._far=s.far,this._perspectiveIsOutOfDate=!1,this._perspective=r.perspective(s.angle*i,s.aspect,s.near,s.far),this._transform=r.identity(),this._matrix=r.mul(this._perspective,this._transform),["angle","aspect","near","far"].forEach(function(t){return Object.defineProperty(o,t,{get:function(){return a["_".concat(t)]},set:function(e){e===a["_".concat(t)]||(a["_".concat(t)]=e,a._perspectiveIsOutOfDate=!0)}})}),n(this,{perspective:function(){return a._perspectiveIsOutOfDate&&a.updatePerspective(),a._perspective},transform:function(){return a._transform},matrix:function(){return a._perspectiveIsOutOfDate&&a.updatePerspective(),a._matrix}})}return _createClass(t,[{key:"orbit",value:function(t,e,n,i,o,a){r.cameraPolar(t,e,n,i,o,a,this._transform),this.updateMatrix()}},{key:"updatePerspective",value:function(){r.perspective(this._angle*i,this._aspect,this._near,this._far,this._perspective),this._perspectiveIsOutOfDate=!1}},{key:"updateMatrix",value:function(){r.mul(this.perspective,this._transform,this._matrix)}}]),t}();e.exports=o,e.exports._=function(){return""}}),require("webgl.math",function(t,e){function n(t){return new Float32Array(t)}function r(t,e,n,r,i,o,a,s,c){return new Float32Array([t,e,n,r,i,o,a,s,c])}function i(t,e,n,r,i,o,a,s,c,u,l,h,f,p,d,v){return new Float32Array([t,e,n,r,i,o,a,s,c,u,l,h,f,p,d,v])}var o=function(){function e(){return r(n,arguments)}var n={en:{},fr:{}},r=t("$").intl;return e.all=n,e}();e.exports={m4:{identity:function(){return i(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},matrix:i,vector:function(t,e,n,r){return new Float32Array([t,e,n,r])},projection:function(t,e,n){return i(2/t,0,0,0,0,-2/e,0,0,0,0,2/n,0,0,0,0,1)},translation:function(t,e,n){return i(1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1)},rotationX:function(t,e){e=e||new Float32Array(16);var n=Math.cos(t),r=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotationY:function(t,e){e=e||new Float32Array(16);var n=Math.cos(t),r=Math.sin(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotationZ:function(t,e){e=e||new Float32Array(16);var n=Math.cos(t),r=Math.sin(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotationXY:function(t,e,n){n=n||new Float32Array(16);var r=Math.cos(t),i=Math.sin(t),o=Math.cos(e),a=Math.sin(e);return n[0]=o,n[1]=i*a,n[2]=-r*a,n[3]=0,n[4]=0,n[5]=r,n[6]=i,n[7]=0,n[8]=a,n[9]=-i*o,n[10]=r*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},rotationYX:function(t,e,n){var r=n||new Float32Array(16),i=Math.cos(t),o=Math.sin(t),a=Math.cos(e),s=Math.sin(e);return r[0]=i,r[1]=0,r[2]=o,r[3]=0,r[4]=-o*s,r[5]=a,r[6]=i*s,r[7]=0,r[8]=-o*a,r[9]=-s,r[10]=i*a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},rotationXZ:function(t,e,n){var r=n||new Float32Array(16),i=Math.cos(t),o=Math.sin(t),a=Math.cos(e),s=Math.sin(e);return r[0]=a,r[1]=i*s,r[2]=o*s,r[3]=0,r[4]=-s,r[5]=i*a,r[6]=o*a,r[7]=0,r[8]=0,r[9]=-o,r[10]=i,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},rotationZX:function(t,e,n){var r=n||new Float32Array(16),i=Math.cos(t),o=Math.sin(t),a=Math.cos(e),s=Math.sin(e);return r[0]=i,r[1]=o,r[2]=0,r[3]=0,r[4]=-o*a,r[5]=i*a,r[6]=s,r[7]=0,r[8]=o*s,r[9]=-i*s,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},scaling:function(t,e,n){return i(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1)},copy:n,normalize:function(t){var e,r,i=n(t),o=0;for(r=0;r<i.length;r++)e=i[r],o+=e*e;if(0<o){var a=1/Math.sqrt(o);for(r=0;r<i.length;r++)i[r]*=a}return i},cameraPolar:function(t,e,n,r,i,o,a){a=a||new Float32Array(16);var s=Math.cos(i),c=Math.sin(i),u=-Math.cos(o+.5*Math.PI),l=-Math.sin(o+.5*Math.PI),h=u*s,f=l*s,p=c,d=-f,v=h,m=0,g=Math.sqrt(d*d+v*v+m*m);d/=g,v/=g,m/=g;var y=f*m-p*v,b=d*p-m*h,w=h*v-f*d,_=-(h*r+t),E=-(f*r+e),T=-(p*r+n);return a[0]=d,a[4]=v,a[8]=m,a[12]=_*d+E*v+T*m,a[1]=y,a[5]=b,a[9]=w,a[13]=_*y+E*b+T*w,a[2]=h,a[6]=f,a[10]=p,a[14]=_*h+E*f+T*p,a[3]=0,a[7]=0,a[11]=0,a[15]=1,a},perspective:function(t,e,n,r,i){i=i||new Float32Array(16);var o=Math.tan(.5*(Math.PI-t)),a=1/(n-r);return i[0]=o/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(n+r)*a,i[11]=-1,i[12]=0,i[13]=0,i[14]=n*r*a*2,i[15]=0,i},mul:function(t,e,n){var r=a["m"+t.length+"m"+e.length];if("function"!=typeof r)throw Error("[webgl.math.mul] I don't know how to multiply 'M"+t.length+"' with 'M"+e.length+"'!");return r(t,e,n)}},m3:{identity:function(){return r(1,0,0,0,1,0,0,0,1)},matrix:r,projection:function(t,e){return r(2/t,0,0,0,-2/e,0,0,0,1)},translation:function(t,e){return r(1,0,0,0,1,0,t,e,1)},rotation:function(t){var e=Math.cos(t),n=Math.sin(t);return r(e,-n,0,n,e,0,0,0,1)},scaling:function(t,e){return r(t,0,0,0,e,0,0,0,1)}},computeBinomialCoeffs:function(t){var e=new Float32Array(t),n=t-1;e[0]=1,e[n]=1;for(var r=1;r<=t/2;r++){for(var i=1,o=1,a=1;a<=r;a++)o*=a,i*=t-1-r+a;var s=i/o;e[r]=s,e[n-r]=s}return e}};var a={m4m4:function(t,e,n){return n=n||new Float32Array(4),n[0]=t[0]*e[0]+t[2]*e[1],n[1]=t[1]*e[0]+t[3]*e[1],n[2]=t[0]*e[2]+t[2]*e[3],n[3]=t[1]*e[2]+t[3]*e[3],n},m9m9:function(t,e,n){return n=n||new Float32Array(9),n[0]=t[0]*e[0]+t[3]*e[1]+t[6]*e[2],n[1]=t[1]*e[0]+t[4]*e[1]+t[7]*e[2],n[2]=t[2]*e[0]+t[5]*e[1]+t[8]*e[2],n[3]=t[0]*e[3]+t[3]*e[4]+t[6]*e[5],n[4]=t[1]*e[3]+t[4]*e[4]+t[7]*e[5],n[5]=t[2]*e[3]+t[5]*e[4]+t[8]*e[5],n[6]=t[0]*e[6]+t[3]*e[7]+t[6]*e[8],n[7]=t[1]*e[6]+t[4]*e[7]+t[7]*e[8],n[8]=t[2]*e[6]+t[5]*e[7]+t[8]*e[8],n},m16m16:function(t,e,n){return n=n||new Float32Array(16),n[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],n[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],n[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],n[3]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],n[4]=t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],n[5]=t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],n[6]=t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],n[7]=t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],n[8]=t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],n[9]=t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],n[10]=t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],n[11]=t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],n[12]=t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],n[13]=t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],n[14]=t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],n[15]=t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15],n},m16m4:function(t,e,n){return n=n||new Float32Array(4),n[0]=t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],n[1]=t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],n[2]=t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],n[3]=t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],n}};e.exports._=o}),require("webgl.resize",function(t,e){var n=function(){function e(){return r(n,arguments)}var n={en:{},fr:{}},r=t("$").intl;return e.all=n,e}();e.exports=function(t,e){var n=void 0===e?window.devicePixelRatio:e,r=Math.floor(t.canvas.clientWidth*n),i=Math.floor(t.canvas.clientHeight*n);return!(t.canvas.width===r&&t.canvas.height===i||(t.canvas.width=r,t.canvas.height=i,t.viewport(0,0,r,i),0))},e.exports._=n}),require("s5.painter.car-wall",function(t,e){function n(t,e){for(var n=[],r=t.createBuffer(),i=0,o=0;o<e;o++)n.push(i+0,i+1,i+2,i+1,i+2,i+3),i+=4;return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),t.STATIC_DRAW),console.info("[car-wall] elem=",n),r}var r={vert:"// Perspective\nuniform mat4 uniProjection;\n// Point\nattribute vec4 attPoint;\n\nvarying vec2 varUV;\n\nvoid main() {\n  varUV = vec2( attPoint.w, attPoint.z );\n  gl_Position = uniProjection * vec4(attPoint.xyz, 1);\n}\n\n\n",frag:"precision mediump float;\n\nuniform vec3 uniColor;\nvarying vec2 varUV;\n\n\nvoid main() {\n  gl_FragColor = vec4(uniColor * (.5 + varUV.y), 1);\n}\n"},i=t("webgl.program"),o=function(){function t(e,o,a){_classCallCheck(this,t),this.gl=e,this.prg=new i(e,r),this.polyline=o,this.color=a,this.buffVert=e.createBuffer(),this.buffElem=n(e,o.capacity)}return _createClass(t,[{key:"paint",value:function(t){var e=this.gl,n=this.prg,r=this.polyline,i=this.buffElem,o=this.buffVert,a=this.color;n.use(),n.$uniColor=a,n.$uniProjection=t,n.bindAttribs(o,"attPoint"),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,r.data,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i),e.drawElements(e.TRIANGLES,6*r.capacity,e.UNSIGNED_SHORT,0)}}]),t}();e.exports=o,e.exports._=function(){return""}}),require("webgl.program",function(t,e){function n(t,e){for(var n,r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<i;o++)n=t.getActiveAttrib(e,o),n.typeName=this.getTypeName(n.type),n.length=w(t,n),n.location=t.getAttribLocation(e,n.name),r[n.name]=n;this.attribs=r,Object.freeze(this.attribs)}function r(t,e){for(var n,r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),o=0;o<i;o++)n=t.getActiveUniform(e,o),r[n.name]=t.getUniformLocation(e,n.name),Object.defineProperty(this,"$".concat(n.name),{set:p.call(this,t,n,r[n.name],this._typesNamesLookup),get:d.call(this,n),enumerable:!0,configurable:!1});this.uniforms=r,Object.freeze(this.uniforms)}function i(t,e){for(var n={},r=Object.keys(t),i=0;i<r.length;i++){var o=r[i],a=t[o];n[o]=a.split("\n").map(function(t){if("#include"!==t.trim().substr(0,8))return t;var n=t.indexOf("#include")+8,r=t.substr(n).trim();"'<\"".indexOf(r.charAt(0))>-1&&(r=r.substr(1,r.length-2));var i=e[r];if("string"!=typeof i)throw console.error("Include <".concat(r,"> not found in "),e),Error("Include not found in shader: ".concat(r));return i}).join("\n")}return n}function o(t,e,n,r){var i=this;return 1===e.size?function(e){t.uniform1i(n,e),i[r]=e}:function(e){t.uniform1iv(n,e),i[r]=e}}function a(t,e,n,r){var i=this;return 1===e.size?function(e){t.uniform1f(n,e),i[r]=e}:function(e){t.uniform1fv(n,e),i[r]=e}}function s(t,e,n,r){var i=this;if(1===e.size)return function(e){t.uniform2fv(n,e),i[r]=e};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_VEC2 in uniform `".concat(e.name,"'!'"))}function c(t,e,n,r){var i=this;if(1===e.size)return function(e){t.uniform3fv(n,e),i[r]=e};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_VEC3 in uniform `".concat(e.name,"'!'"))}function u(t,e,n,r){var i=this;if(1===e.size)return function(e){t.uniform4fv(n,e),i[r]=e};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_VEC4 in uniform `".concat(e.name,"'!'"))}function l(t,e,n,r){var i=this;if(1===e.size)return function(e){t.uniformMatrix2fv(n,!1,e),i[r]=e};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT2 in uniform `".concat(e.name,"'!'"))}function h(t,e,n,r){var i=this;if(1===e.size)return function(e){t.uniformMatrix3fv(n,!1,e),i[r]=e};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT3 in uniform `".concat(e.name,"'!'"))}function f(t,e,n,r){var i=this;if(1===e.size)return function(e){t.uniformMatrix4fv(n,!1,e),i[r]=e};throw Error("[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT4 in uniform `".concat(e.name,"'!'"))}function p(t,e,n,r){var i="_$".concat(e.name);switch(e.type){case t.BYTE:case t.UNSIGNED_BYTE:case t.SHORT:case t.UNSIGNED_SHORT:case t.INT:case t.UNSIGNED_INT:case t.SAMPLER_2D:return o.call(this,t,e,n,i);case t.FLOAT:return a.call(this,t,e,n,i);case t.FLOAT_VEC2:return s.call(this,t,e,n,i);case t.FLOAT_VEC3:return c.call(this,t,e,n,i);case t.FLOAT_VEC4:return u.call(this,t,e,n,i);case t.FLOAT_MAT2:return l.call(this,t,e,n,i);case t.FLOAT_MAT3:return h.call(this,t,e,n,i);case t.FLOAT_MAT4:return f.call(this,t,e,n,i);default:throw Error("[webgl.program.createUniformSetter] Don't know how to deal with uniform `".concat(e.name,"` of type ").concat(r[e.type],"!"))}}function d(t){var e=this,n="_$".concat(t.name);return function(){return e[n]}}function v(t,e,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)?r:(console.error("An error occurred compiling the shader: ".concat(e.getShaderInfoLog(r))),console.warn(n),null)}function m(t,e){return v(t.FRAGMENT_SHADER,t,e)}function g(t,e){return v(t.VERTEX_SHADER,t,e)}function y(t){for(var e={},n=Object.keys(t),r=0;r<n.length;r++){var i=n[r],o=t[i];"number"==typeof o&&(e[o]=i)}return e}function b(t,e){return y(t)[e]}function w(t,e){switch(e.type){case t.FLOAT_VEC4:return 4;case t.FLOAT_VEC3:return 3;case t.FLOAT_VEC2:return 2;case t.FLOAT:return 1;default:throw Error("[webgl.program:getSize] I don't know the size of the attribute '".concat(e.name,"' because I don't know the type ").concat(b(e.type),"!"))}}function _(t,e,n){return"string"==typeof e?void("function"==typeof n?Object.defineProperty(t,e,{get:n,set:function(){throw Error('The attribute "'.concat(e,'" is read onyl!'))},configurable:!1,enumerable:!0}):Object.defineProperty(t,e,{value:n,writable:!1,configurable:!1,enumerable:!0})):void Object.keys(e).forEach(function(n){_(t,n,e[n])})}var E=function(){function e(){return r(n,arguments)}var n={en:{},fr:{}},r=t("$").intl;return e.all=n,e}(),T=(new Float32Array).BYTES_PER_ELEMENT,A=function(){function t(e,o,a){if(_classCallCheck(this,t),"string"!=typeof o.vert)throw Error("[webgl.program] Missing attribute `vert` in argument `codes`!");if("string"!=typeof o.frag)throw Error("[webgl.program] Missing attribute `frag` in argument `codes`!");var s=i(o,a);this.gl=e,Object.freeze(this.gl),this.BPE=T,Object.freeze(this.BPE),this._typesNamesLookup=y(e);var c=e.createProgram();e.attachShader(c,g(e,s.vert)),e.attachShader(c,m(e,s.frag)),e.linkProgram(c),this.program=c,Object.freeze(this.program),this.use=function(){e.useProgram(c)},this.use(),n.call(this,e,c),r.call(this,e,c)}return _createClass(t,[{key:"getTypeName",value:function(t){return this._typesNamesLookup[t]}},{key:"bindAttribs",value:function(t){var e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t);for(var n=0,r=arguments.length,i=Array(1<r?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(var a=0;a<i.length;a++){var s=i[a],c=this.attribs[s];if(!c)throw Error('Cannot find attribute "'.concat(s,'"!\n')+"It may be not active because unused in the shader.\n"+"Available attributes are: ".concat(Object.keys(this.attribs).map(JSON.stringify).join(", ")));n+=c.size*c.length*T}var u=0;i.forEach(function(t){var r=this.attribs[t];e.enableVertexAttribArray(r.location),e.vertexAttribPointer(r.location,r.size*r.length,e.FLOAT,!1,n,u),u+=r.size*r.length*T},this)}},{key:"readonly",value:function(t,e,n){return _(taget,e,n)}}]),t}();e.exports=A,e.exports._=E}),require("s5.polyline",function(t,e){function n(t,e,n){if(e===n)return!1;for(var r=this._arr,o=this._capacity,a=i(this)?0:16,s=Math.min(e,n),c=Math.max(e,n),u=a;u<this._length;u+=32){var l=(u+this._start)%o,h=r[l+0],f=r[l+8],p=r[l+1];if(h===f)break;var d=Math.min(h,f),v=Math.max(h,f);if(!(t<=d||t>=v||p<s||p>c))return!0}return!1}function r(t,e,n){if(e===n)return!1;for(var r=this._arr,o=this._capacity,a=i(this)?16:0,s=Math.min(e,n),c=Math.max(e,n),u=a;u<this._length;u+=32){var l=(u+this._start)%o,h=r[l+1],f=r[l+9],p=r[l+0];if(h===f)break;var d=Math.min(h,f),v=Math.max(h,f);if(!(t<=d||t>=v||p<s||p>c))return!0}return!1}function i(t){var e=t._start,n=t._arr;return n[e+0]!==n[e+8]}var o=t("common"),a=o.readonly,s=0,c=1,u=2,l=3,h=4,f=5,p=6,d=7,v=8,m=9,g=10,y=11,b=12,w=13,_=14,E=15,T=16,A=function(){function t(e,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:128;_classCallCheck(this,t);var i=new Float32Array(r*T),o=this;i[s]=e,i[c]=n,i[u]=0,i[l]=0,i[h]=e,i[f]=n,i[p]=1,i[d]=0,i[v]=e,i[m]=n,i[g]=0,i[y]=0,i[b]=e,i[w]=n,i[_]=1,i[E]=0,this._arr=i,this._start=0,this._length=T,this._capacity=i.length,a(this,{data:function(){return i},capacity:function(){return r},length:function(){return o._length},firstX:function(){return o._arr[o._start+s]},firstY:function(){return o._arr[o._start+c]},lastX:function(){var t=o._length-T+o._start;return o._arr[(t+v)%o._capacity]},lastY:function(){var t=o._length-T+o._start;return o._arr[(t+m)%o._capacity]}})}return _createClass(t,[{key:"foreachTail",value:function(t){for(var e,n=this._arr,r=this._capacity,i=this._length,o=0;o<i;o+=T)e=(o+this._start)%r,t(n[e+v],n[e+m])}},{key:"move",value:function(t,e){var n=this._length-T,r=(this._start+n)%this._capacity;this._arr[r+v]+=t,this._arr[r+b]=this._arr[r+v],this._arr[r+m]+=e,this._arr[r+w]=this._arr[r+m];var i=Math.max(Math.abs(this._arr[r+v]-this._arr[r+s]),Math.abs(this._arr[r+m]-this._arr[r+c]));this._arr[r+y]=this._arr[r+E]=this._arr[r+l]+i}},{key:"add",value:function(){var t,e=this._length-T,n=(this._start+e)%this._capacity,r=this._arr,i=r[n+v],o=r[n+m],a=r[n+y];e<this._capacity?(t=(n+T)%this._capacity,this._length+=T):(t=this._start,this._start=(this._start+T)%this._capacity),r[t+s]=r[t+v]=i,r[t+h]=r[t+b]=i,r[t+c]=r[t+m]=o,r[t+f]=r[t+w]=o,r[t+l]=r[t+y]=a,r[t+d]=r[t+E]=a,r[t+u]=r[t+g]=0,r[t+p]=r[t+_]=1}},{key:"collide",value:function(t,e,i,o){return t===i?n.call(this,t,e,o):r.call(this,e,t,i)}}]),t}();e.exports=A,e.exports._=function(){return""}}),require("common",function(t,e){function n(t,e,r){return"string"==typeof e?void("function"==typeof r?Object.defineProperty(t,e,{get:r,set:function(){},configurable:!1,enumerable:!0}):Object.defineProperty(t,e,{value:r,writable:!1,configurable:!1,enumerable:!0})):void Object.keys(e).forEach(function(r){n(t,r,e[r])})}e.exports={readonly:n},e.exports._=function(){return""}}),require("s5.tron.action",function(t,e,n){var r=t("s5.tron.action.keyboard"),i=t("s5.tron.action.ai");n.create=function(t){switch(t.type){case"keyboard":return r.create(t);case"ai":return i.create(t);default:return null}},e.exports._=function(){return""}}),require("s5.tron.action.ai",function(t,e,n){function r(){return 1e3*Math.random()}var i=t("common"),o=i.readonly,a=0,s=1,c=2,u=3,l=function(){function t(e){var n=e.car,r=e.cars,i=e.boundaries,l=e.reaction,h=void 0===l?150:l,f=e.frontRadar,p=void 0===f?10:f,d=e.sideRadar,v=void 0===d?20:d;_classCallCheck(this,t);var m=this;this.status=a,this.car=n,this.cars=r,this.boundaries=i,this.lastTime=0,o(this,{reaction:h,frontRadar:p,sideRadar:v,actionRight:function(){return m.status===c},actionLeft:function(){return m.status===s},actionAccel:function(){return m.status===u}})}return _createClass(t,[{key:"process",value:function(t){if(t-this.lastTime<this.reaction)return void(this.status=a);var e=this.car,n=e.polyline.lastX,i=e.polyline.lastY,o=n+e.vx*this.frontRadar,s=i+e.vy*this.frontRadar;if(this.collide(n,i,o,s))r()<500?this.turnRightIfSafe():this.turnLeftIfSafe();else{var c=r();3>c?this.turnRightIfSafe():6>c?this.turnLeftIfSafe():this.status=8>c?u:a}this.status!==a&&(this.lastTime=t)}},{key:"turnRightIfSafe",value:function(){var t=this.car,e=t.polyline.lastX,n=t.polyline.lastY,r=e+t.vxRight*this.sideRadar,i=n+t.vyRight*this.sideRadar;this.status=this.collide(e,n,r,i)?a:c}},{key:"turnLeftIfSafe",value:function(){var t=this.car,e=t.polyline.lastX,n=t.polyline.lastY,r=e+t.vxLeft*this.sideRadar,i=n+t.vyLeft*this.sideRadar;this.status=this.collide(e,n,r,i)?a:s}},{key:"collide",value:function(t,e,n,r){var i=!0,o=!1,a=void 0;try{for(var s,c,u=this.cars[Symbol.iterator]();!(i=(s=u.next()).done);i=!0)if(c=s.value,!c.isDead&&c.polyline.collide(t,e,n,r))return!0}catch(t){o=!0,a=t}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var l=!0,h=!1,f=void 0;try{for(var p,d,v=this.boundaries[Symbol.iterator]();!(l=(p=v.next()).done);l=!0)if(d=p.value,d.collide(t,e,n,r))return!0}catch(t){h=!0,f=t}finally{try{l||null==v.return||v.return()}finally{if(h)throw f}}return!1}}]),t}();n.create=function(t){return new l(t)},e.exports._=function(){return""}}),require("s5.tron.action.keyboard",function(t,e){function n(){o.isLoaded||(o.isLoaded=!0,document.addEventListener("keydown",function(t){if(!t.repeat)switch(t.key){case e.exports.RightKey:o.rightPressed=!0,t.preventDefault();break;case e.exports.LeftKey:o.leftPressed=!0,t.preventDefault();break;case e.exports.AccelKey:o.accelPressed=!0,t.preventDefault()}},!0),document.addEventListener("keyup",function(t){switch(t.key){case o.RightKey:case o.LeftKey:case o.AccelKey:t.preventDefault()}},!0))}e.exports={create:function(t){return new a(t)},RightKey:"ArrowRight",LeftKey:"ArrowLeft",AccelKey:" "};var r=t("common"),i=r.readonly,o={isLoaded:!1,rightPressed:!1,leftPressed:!1,accelPressed:!1},a=function(){function t(){_classCallCheck(this,t),i(this,{actionRight:function(){var t=o.rightPressed;return o.rightPressed=!1,t},actionLeft:function(){var t=o.leftPressed;return o.leftPressed=!1,t},actionAccel:function(){var t=o.accelPressed;return o.accelPressed=!1,t}}),n()}return _createClass(t,[{key:"process",value:function(){}}]),t}();e.exports._=function(){return""}}),require("s5.car",function(t,e){var n=t("s5.polyline"),r=t("common"),i=r.readonly,o=0,a=1,s=[[0,-1],[1,0],[0,1],[-1,0]],c=s.length,u=3,l=1,h=function(){function t(e){var r=e.action,h=e.x,f=void 0===h?0:h,p=e.y,d=void 0===p?0:p,v=e.dir,m=void 0===v?u:v,g=e.color,y=void 0===g?"cyan":g,b=e.minSpeed,w=void 0===b?.01:b,_=e.maxSpeed,E=void 0===_?.05:_,T=e.breakPower,A=void 0===T?5e-5:T;_classCallCheck(this,t);var x=this;this.action=r,this.speed=w,this.lastTime=0,this.dir=m,i(this,{minSpeed:w,maxSpeed:E,breakPower:A,color:y,polyline:new n(f,d),dirRight:function(){return(x.dir+u)%c},dirLeft:function(){return(x.dir+l)%c},vx:function(){return s[x.dir][o]},vy:function(){return s[x.dir][a]},vxRight:function(){return s[x.dirRight][o]},vyRight:function(){return s[x.dirRight][a]},vxLeft:function(){return s[x.dirLeft][o]},vyLeft:function(){return s[x.dirLeft][a]}})}return _createClass(t,[{key:"move",value:function(t){if(0===this.lastTime)return void(this.lastTime=t);var e=t-this.lastTime;this.lastTime=t,this.action.process(t,e),this.speed>this.minSpeed&&(this.speed=Math.max(this.minSpeed,this.speed-this.breakPower*e));var n=this.action;n.actionRight?(this.polyline.add(),this.dir=(this.dir+u)%s.length):n.actionLeft&&(this.polyline.add(),this.dir=(this.dir+l)%s.length),n.actionAccel&&(this.speed=this.maxSpeed);var r=s[this.dir],i=this.speed*e*r[0],o=this.speed*e*r[1];this.polyline.move(i,o)}}]),t}();e.exports=h,e.exports._=function(){return""}}),require("dom",function(t,e){function n(t){if(t instanceof Node)return t;if(void 0===t||null===t)throw Error("`dom` is not a valid element!",t);if(t.$ instanceof Node)return t.$;if(t.element instanceof Node)return t.element;if("string"==typeof t){var e=document.getElementById(t);return e||console.error("[dom] There is no DOM element with this ID: `"+t+"`"),e}return"function"==typeof t.element?t.element():t}function r(t,e){t=n(t);var r,i;for(r in e)i=e[r],t.style[r]=i;return t}function i(t,e,r){t=n(t);var i,o;for(i in"string"==typeof e&&(void 0===r&&(r=""),i=e,e={},e[i]=r),e)o=e[i],t.setAttribute(i,o);return t}function o(t){t=n(t);try{var e,r;for(e=1;e<arguments.length;e++)r=arguments[e],c(t,r)||s(t,r)||a(t,r)||console.error("Argument #"+e+" of dom.add() is invalid!",arguments);return t}catch(t){console.error("[DOM.add] arguments=",[].slice.call(arguments)),console.error("[DOM.add] exception=",t)}}function a(t,e){return!!((e=n(e))instanceof Node)&&(t.appendChild(e),!0)}function s(t,e){if("number"==typeof e&&(e=""+e),"string"!=typeof e)return!1;if("<html>"==e.substr(0,6).toLowerCase()){var r=e.substr(6);e=n.tag("span"),e.innerHTML=r}else if(E.test(e)){var i=e;e=n.tag("span"),e.innerHTML=i}else e=document.createTextNode(e);return t.appendChild(e),!0}function c(t,e){return!!Array.isArray(e)&&(e.forEach(function(e){o(t,e)}),!0)}function u(t){if(Array.isArray(t))return t.forEach(function(t){u(t)}),t;if(void 0===t[_])return t;var e=t[_].events;return void 0===e?t:(e.off(),
void delete t[_].events)}function l(t,e,r){if("function"==typeof e||null===e)e={tap:e};else if("string"==typeof e&&"function"==typeof r){var i={};i[e]=r,e=i}if(Array.isArray(t))return t.forEach(function(t){l(t,e)}),t;t=n(t),void 0===t[_]&&(t[_]={}),void 0===t[_].events&&(t[_].events=w(t));var o,a,s;for(o in e)a=e[o],"!"==o.charAt(0)?(o=o.substr(1),s=!0):s=!1,-1<T.indexOf(o.toLowerCase())?t.addEventListener(o,a,s):t[_].events.on(o,a,s);return t}function h(t,e){try{var r,i,a,s,c=document.createElementNS(t,e.trim().toLowerCase());for(r=2;r<arguments.length;r++)if(i=arguments[r],Array.isArray(i))i.forEach(function(t){switch(_typeof(t)){case"string":case"number":case"boolean":if(t=""+t,"<html>"==t.substr(0,6)){var e=t.substr(6);t=n.tag("span"),t.innerHTML=e}else t=document.createTextNode(t)}o(c,t)});else switch(_typeof(i)){case"string":i.split(" ").forEach(function(t){0<t.length&&f(c,t)});break;case"object":for(a in i)s=i[a],c.setAttribute(a,s);break;default:throw Error("[dom.tag] Error creating <"+e+">: Invalid argument #"+r+"!")}return c}catch(n){console.error("[dom.tagNS] Error with `ns` = ",t," and `name` = ",e),console.error(n)}}function f(t){var e=[].slice.call(arguments,1);return Array.isArray(t)?(e.unshift(null),t.forEach(function(t){e[0]=t,f.apply(void 0,e)}),t):(t=n(t),e.forEach(function(e){if("string"==typeof e&&(e=e.trim(),0!=e.length))try{t.classList&&t.classList.add(e)}catch(t){console.error("[dom.addClass] Invalid class name: ",e),console.error(t)}}),t)}function p(t,e){return t=n(t),!!t.classList&&t.classList.contains(e)}function d(t){var e=[].slice.call(arguments,1);return Array.isArray(t)?(e.unshift(null),t.forEach(function(t){e[0]=t,d.apply(void 0,e)}),t):(t=n(t),e.forEach(function(e){if("string"==typeof e)try{t.classList&&t.classList.remove(e)}catch(t){console.error("[dom.removeClass] Invalid class name: ",e),console.error(t)}}),t)}function v(t){return[].slice.call(arguments,1).forEach(function(e){p(t,e)?d(t,e):f(t,e)}),t}function m(t){return Array.isArray(t)?void t.forEach(function(t){t=n(t),void 0===t[_]&&(t[_]={}),Array.isArray(t[_].style)||(t[_].style=[]),t[_].style.push(JSON.stringify(t.style))}):m(Array.prototype.slice.call(arguments))}function g(t){return Array.isArray(t)?void t.forEach(function(t){if(t=n(t),void 0===t[_]||!Array.isArray(t[_].style))throw Error("[dom.restoreStyle] `saveStyle()` has never been used on this element!");if(0==t[_].style.length)throw Error("[dom.restoreStyle] more `restore` than `save`!");var e,r,i=JSON.parse(t[_].style.pop());for(e in i)void 0!==(r=i[e])&&(t.style[e]=r)}):g(Array.prototype.slice.call(arguments))}var y=function(){function e(){return r(n,arguments)}var n={en:{}},r=t("$").intl;return e.all=n,e}();t("polyfill.classList");var b=t("dom.theme"),w=t("tfw.gestures"),_="@dom"+Date.now(),E=/^&(#[0-9]+|[a-zA-Z0-9]+);$/;e.exports=n,n.tagNS=h,n.svgRoot=h.bind(void 0,"http://www.w3.org/2000/svg","svg",{version:"1.1","xmlns:svg":"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}),n.svg=h.bind(void 0,"http://www.w3.org/2000/svg"),n.tag=h.bind(void 0,"http://www.w3.org/1999/xhtml"),n.div=h.bind(void 0,"http://www.w3.org/1999/xhtml","div"),n.txt=window.document.createTextNode.bind(window.document),n.textOrHtml=function(t,e){return void 0===e&&(e=""),null===e&&(e=""),"string"!=typeof e&&(e=JSON.stringify(e)),"<html>"==e.substr(0,6)?t.innerHTML=e.substr(6):t.textContent=e,t},n.get=function(t,e){return t=n(t),void 0===e&&(e=t,t=window.document),t.querySelector(e)},n.elem=function(t){var e=[].slice.call(arguments);e.shift(),0==e.length&&(e=["div"]),e.push("dom","custom");var r;return void 0===e[0].element?"function"==typeof e[0].appendChild?(r=e[0],f(r,"dom","custom")):r=n.tag.apply(n,e):(r=e[0].element,f(r,"dom","custom")),Object.defineProperty(t,"element",{value:r,writable:!1,configurable:!1,enumerable:!0}),r},n.css=r,n.att=i,n.removeAtt=function(t,e){return t=n(t),t.removeAttribute(e),t},n.addClass=f,n.hasClass=p,n.removeClass=d,n.toggleClass=v,n.saveStyle=m,n.restoreStyle=g,n.registerTheme=b.register.bind(n),n.applyTheme=b.apply.bind(n),n.registerAndApplyTheme=function(t,e){b.register.call(this,t,e),b.apply.call(this,t)},n.replace=function(t,e){return t=n(t),e=n(e),e.parentNode.replaceChild(t,e),t},n.detach=function(t){t=n(t);var e=t.parentElement;return e?(e.removeChild(t),e):e},n.on=l,n.off=u,n.add=o,n.wrap=function(t,e,n){return Object.defineProperty(t,"element",{value:e,writable:!1,configurable:!1,enumerable:!0}),n?t:(t.on=l.bind(t,e),t.css=r.bind(t,e),t.add=o.bind(t,e),t.att=i.bind(t,e),t.addClass=f.bind(t,e),t.hasClass=p.bind(t,e),t.removeClass=d.bind(t,e),t.toggleClass=v.bind(t,e),t)},n.clear=function(t){t=n(t);for(var e=t;e.firstChild;)e.removeChild(e.firstChild);var r=[].slice.call(arguments);return 1<r.length&&o.apply(this,r),t};var T=["keyup","keydown","scroll","load","error"];e.exports._=y}),require("tfw.gestures",function(t,e){function n(t,e){for(var n=this._events[t].chain,r=0;r<n.length;r++)if(!0===(0,n[r])(e))return}function r(t,e){var r=l(t,"hammer.");r&&!this._hammer&&(this._hammer=new m(this.$,{domEvents:!0}),this._hammer.domEvents=!0);var i=this._events[t];if(!i){var o=n.bind(this,t);i={chain:[],handler:o},r?this._hammer.on(r,o):this.$.addEventListener(t,o),this._events[t]=i}i.chain.push(e)}function i(t,e){if("string"!=typeof t)throw Error("[Gestures.on] `name` must be a string: "+JSON(t)+"!");if(-1===v.indexOf(t))throw Error("Unknown gesture's name `"+t+"`!\nAvailable names are: "+v.join(", ")+".");if("function"!=typeof e)throw Error("Gesture `"+t+"` must have a function as slot!")}function o(t){if(t instanceof Node)return t;if(void 0===t||null===t)throw Error("Not a valid DOM element!",t);if(t.$ instanceof Node)return t.$;if(t.element instanceof Node)return t.element;if("string"==typeof t){var e=document.getElementById(t);return e||console.error("There is no DOM element with this ID: `"+t+"`"),e}return"function"==typeof t.element?t.element():t}function a(t,e){var n,r;n=e.center.x,r=e.center.y;var i=t.getBoundingClientRect();e.x=n-i.left,e.y=r-i.top}function s(t,e){var n,r;n=e.clientX,r=e.clientY;var i=t.getBoundingClientRect();return{x:n-i.left,y:r-i.top}}function c(t,e){e.vx=e.x-this._dragX,e.vy=e.y-this._dragY,e.x0=e.x-e.deltaX,e.y0=e.y-e.deltaY,this._dragX=e.x,this._dragY=e.y}function u(t){if(!t||!t.srcEvent)return 0;var e=t.srcEvent.buttons;return"number"==typeof e?e:0}function l(t,e){return t.substr(0,e.length)==e?t.substr(e.length):null}var h=function(){function e(){return r(n,arguments)}var n={en:{},fr:{}},r=t("$").intl;return e.all=n,e}();e.exports=function(t){var e=o(t);return e[p]||(e[p]=new g(e)),e[p]};var f={tap:function(t,e){var n=this;t("hammer.tap",function(t){return!(1!==t.tapCount||(a(n.$,t),e({x:t.x,y:t.y,target:t.target,preventDefault:t.preventDefault.bind(t)}),0))})},doubletap:function(t,e){var n=this;t("hammer.tap",function(t){return!(2!==t.tapCount||(a(n.$,t),e({x:t.x,y:t.y,target:t.target,preventDefault:t.preventDefault.bind(t)}),0))})},drag:function(t,e,n){var r=this;t("hammer.pan",function(t){if(t.isFinal)return!1;a(r.$,t),void 0===r._dragX&&(r._dragX=t.x,r._dragY=t.y,r._dragStart=!0),c.call(r,r.$,t);var i=t.srcEvent;return e({x:t.x,y:t.y,x0:t.x0,y0:t.y0,vx:t.vx,vy:t.vy,sx:t.velocityX,sy:t.velocityY,event:t,target:t.target,buttons:u(t),preventDefault:i.preventDefault.bind(i),stopPropagation:i.stopImmediatePropagation.bind(i)},n),!0})},dragstart:function(t,e){var n=this;t("hammer.panstart",function(t){console.log("START"),a.call(n,n.$,t);var r=t.srcEvent;return e({x:t.x,y:t.y,target:t.target,preventDefault:r.preventDefault.bind(r),stopPropagation:r.stopImmediatePropagation.bind(r)}),!0})},dragend:function(t,e){var n=this;t("hammer.panend",function(t){a(n.$,t),c.call(n,n.$,t);var r=t.srcEvent;return e({x:t.x,y:t.y,x0:t.x0,y0:t.y0,target:t.target,preventDefault:r.preventDefault.bind(r),stopPropagation:r.stopImmediatePropagation.bind(r)}),delete n._dragX,delete n._dragY,!0})},move:function(t,e){var n=this;t("mousemove",function(t){var r=s(n.$,t);r.preventDefault=t.preventDefault.bind(t),r.stopPropagation=t.stopPropagation.bind(t),r.event=t,e(r)})},down:function(t,e){var n=this;t("touchstart",function(t){if(!t.changedTouches||1>t.changedTouches.length)return!1;var r=t.changedTouches[0],i=n.$.getBoundingClientRect();try{e({x:r.clientX-i.left,y:r.clientY-i.top,preventDefault:t.preventDefault.bind(t),stopPropagation:t.stopPropagation.bind(t)})}catch(t){console.error(t)}return!0}),t("mousedown",function(t){if(350>Date.now()-n._touchstart)return t.preventDefault(),t.stopPropagation(),!1;var r=n.$.getBoundingClientRect();try{e({x:t.clientX-r.left,y:t.clientY-r.top,preventDefault:t.preventDefault.bind(t),stopPropagation:t.stopPropagation.bind(t)})}catch(t){console.error(t)}return n._touchstart=0,!0})},up:function(t,e){var n=this;t("touchend",function(t){if(!t.changedTouches||1>t.changedTouches.length)return!1;var r=t.changedTouches[0],i=n.$.getBoundingClientRect();try{e({x:r.clientX-i.left,y:r.clientY-i.top,preventDefault:t.preventDefault.bind(t),stopPropagation:t.stopPropagation.bind(t)})}catch(t){console.error(t)}return n._touchstart=Date.now(),!0}),t("mouseup",function(t){if(0<n._touchstart)return t.preventDefault(),t.stopPropagation(),!1;var r=n.$.getBoundingClientRect();try{e({x:t.clientX-r.left,y:t.clientY-r.top,preventDefault:t.preventDefault.bind(t),stopPropagation:t.stopPropagation.bind(t)})}catch(t){console.error(t)}return n._touchstart=0,!0})},wheel:function(t,e){var n=this;t(d,function(t){var r=s(n.$,t);r.delta=t.deltaY,"number"!=typeof r.delta&&(r.delta=-t.wheelDelta),r.preventDefault=t.preventDefault.bind(t),r.stopPropagation=t.stopPropagation.bind(t),e(r)})}},p=Symbol("__tfw.gestures__"),d=function(){return"onwheel"in document.createElement("div")?"wheel":void 0===document.onmousewheel?"DOMMouseScroll":"mousewheel"}(),v=Object.keys(f),m=t("external.hammer"),g=function(){function t(e){_classCallCheck(this,t),Object.defineProperty(this,"$",{writable:!1,value:e,configurable:!1}),this._events={},this._touchstart=0}return _createClass(t,[{key:"on",value:function(t,e,n){var o="function"==typeof t,a=o?"tap":t,s=o?t:e,c=o?e:n;try{return i(a,s),f[a].call(this,r.bind(this),s,c),this}catch(t){throw console.error("[Gesture.on( name, slot, args )]"),console.error("   name",a),console.error("   slot",s),console.error("   args",c),console.error("   ERROR",t),Error(t)}}}]),t}();e.exports._=h}),require("external.hammer",function(t,e){var n=function(){function e(){return r(n,arguments)}var n={en:{},fr:{}},r=t("$").intl;return e.all=n,e}();(function(t,n,r){function i(t,e,n){return setTimeout(u(t,n),e)}function o(t,e,n){return!!Array.isArray(t)&&(a(t,n[e],n),!0)}function a(t,e,n){if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(var r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function s(e,n,r){return function(){var i=new Error("get-stack-trace"),o=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=t.console&&(t.console.warn||t.console.log);return a&&a.call(t.console,"DEPRECATED METHOD: "+n+"\n"+r+" AT \n",o),e.apply(this,arguments)}}function c(t,e,n){var r=e.prototype,i=t.prototype=Object.create(r);i.constructor=t,i._super=r,n&&lt(i,n)}function u(t,e){return function(){return t.apply(e,arguments)}}function l(t,e){return"function"==_typeof(t)?t.apply(e?e[0]||void 0:void 0,e):t}function h(t,e){return void 0===t?e:t}function f(t,e,n){a(m(e),function(e){t.addEventListener(e,n,!1)})}function p(t,e,n){a(m(e),function(e){t.removeEventListener(e,n,!1)})}function d(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function v(t,e){return-1<t.indexOf(e)}function m(t){return t.trim().split(/\s+/g)}function g(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function y(t){return Array.prototype.slice.call(t,0)}function b(t,e,n){for(var r,i=[],o=[],a=0;a<t.length;)r=e?t[a][e]:t[a],0>g(o,r)&&i.push(t[a]),o[a]=r,a++;return n&&(i=e?i.sort(function(t,n){return t[e]>n[e]}):i.sort()),i}function w(t,e){for(var n=e[0].toUpperCase()+e.slice(1),r=0;r<ht.length;){var i=ht[r],o=i?i+n:e;if(o in t)return o;r++}}function _(){return yt++}function E(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}function T(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){l(t.options.enable,[t])&&n.handler(e)},this.init()}function A(t){var e=t.options.inputClass;return new(e||(_t?Y:Et?z:wt?q:N))(t,x)}function x(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&0==r-i;n.isFirst=!!o,n.isFinal=!!(12&e&&0==r-i),o&&(t.session={}),n.eventType=e,P(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function P(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=M(e)),1<i&&!n.firstMultiple?n.firstMultiple=M(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,c=e.center=k(r);e.timeStamp=vt(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=I(s,c),e.distance=R(s,c),C(n,e),e.offsetDirection=L(e.deltaX,e.deltaY);var u=D(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=dt(u.x)>dt(u.y)?u.x:u.y,e.scale=a?F(a.pointers,r):1,e.rotation=a?O(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,S(n,e);var l=t.element;d(e.srcEvent.target,l)&&(l=e.srcEvent.target),e.target=l}function C(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};(1===e.eventType||4===o.eventType)&&(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}function S(t,e){var n,r,i,o,a=t.lastInterval||e,s=e.timeStamp-a.timeStamp;if(8!==e.eventType&&(s>25||void 0===a.velocity)){var c=e.deltaX-a.deltaX,u=e.deltaY-a.deltaY,l=D(s,c,u);r=l.x,i=l.y,n=dt(l.x)>dt(l.y)?l.x:l.y,o=L(c,u),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}function M(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:pt(t.pointers[n].clientX),clientY:pt(t.pointers[n].clientY)},n++;return{timeStamp:vt(),pointers:e,center:k(e),deltaX:t.deltaX,deltaY:t.deltaY}}function k(t){var e=t.length;if(1===e)return{x:pt(t[0].clientX),y:pt(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:pt(n/e),y:pt(r/e)}}function D(t,e,n){return{x:e/t||0,y:n/t||0}}function L(t,e){return t===e?1:dt(t)>=dt(e)?0>t?2:4:0>e?8:16}function R(t,e,n){n||(n=Tt);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function I(t,e,n){n||(n=Tt);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}function O(t,e){return I(e[1],e[0],At)+I(t[1],t[0],At)}function F(t,e){return R(e[0],e[1],At)/R(t[0],t[1],At)}function N(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,T.apply(this,arguments)}function Y(){this.evEl=St,this.evWin=Mt,T.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function j(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,T.apply(this,arguments)}function X(t,e){var n=y(t.touches),r=y(t.changedTouches);return 12&e&&(n=b(n.concat(r),"identifier",!0)),[n,r]}function z(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},T.apply(this,arguments)}function B(t,e){var n=y(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=y(t.changedTouches),s=[],c=this.target;if(o=n.filter(function(t){return d(t.target,c)}),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),12&e&&delete r[a[i].identifier],i++;return s.length?[b(o.concat(s),"identifier",!0),s]:void 0}function q(){T.apply(this,arguments);var t=u(this.handler,this);this.touch=new z(this.manager,t),this.mouse=new N(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function $(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,H.call(this,e)):12&t&&H.call(this,e)}function H(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches,i=function(){var t=r.indexOf(n);-1<t&&r.splice(t,1)};setTimeout(i,2500)}}function U(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}function G(t,e){this.manager=t,this.set(e)}function V(t){if(v(t,"none"))return"none";var e=v(t,"pan-x"),n=v(t,"pan-y");return e&&n?"none":e||n?e?"pan-x":"pan-y":v(t,"manipulation")?"manipulation":"auto"}function W(t){this.options=lt({},this.defaults,t||{}),this.id=_(),this.manager=null,this.options.enable=h(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function K(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Z(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function J(t,e){var n=e.manager;return n?n.get(t):t}function Q(){W.apply(this,arguments)}function tt(){Q.apply(this,arguments),this.pX=null,this.pY=null}function et(){Q.apply(this,arguments)}function nt(){W.apply(this,arguments),this._timer=null,this._input=null}function rt(){Q.apply(this,arguments)}function it(){Q.apply(this,arguments)}function ot(){W.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function at(t,e){return e=e||{},e.recognizers=h(e.recognizers,at.defaults.preset),new st(t,e)}function st(t,e){this.options=lt({},at.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=A(this),this.touchAction=new G(this,this.options.touchAction),ct(this,!0),a(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ct(t,e){var n=t.element;if(n.style){var r;a(t.options.cssProps,function(i,o){r=w(n.style,o),e?(t.oldCssProps[r]=n.style[r],n.style[r]=i):n.style[r]=t.oldCssProps[r]||""}),e||(t.oldCssProps={})}}function ut(t,e){var r=n.createEvent("Event");r.initEvent(t,!0,!0),r.gesture=e,e.target.dispatchEvent(r)}var lt,ht=["","webkit","Moz","MS","ms","o"],ft=n.createElement("div"),pt=Math.round,dt=Math.abs,vt=Date.now;lt="function"==typeof Object.assign?Object.assign:function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e,n=Object(t),r=1;r<arguments.length;r++)if(void 0!==(e=arguments[r])&&null!==e)for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n};var mt=s(function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&void 0===t[r[i]])&&(t[r[i]]=e[r[i]]),i++;return t},"extend","Use `assign`."),gt=s(function(t,e){return mt(t,e,!0)},"merge","Use `assign`."),yt=1,bt=/mobile|tablet|ip(ad|hone|od)|android/i,wt="ontouchstart"in t,_t=void 0!==w(t,"PointerEvent"),Et=wt&&bt.test(navigator.userAgent),Tt=["x","y"],At=["clientX","clientY"];T.prototype={handler:function(){},init:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(E(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(E(this.element),this.evWin,this.domHandler)}};var xt={mousedown:1,mousemove:2,mouseup:4};c(N,T,{handler:function(t){var e=xt[t.type];1&e&&2!==t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var Pt={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Ct={2:"touch",3:"pen",4:"mouse",5:"kinect"},St="pointerdown",Mt="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(St="MSPointerDown",Mt="MSPointerMove MSPointerUp MSPointerCancel"),c(Y,T,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Pt[r],o=Ct[t.pointerType]||t.pointerType,a=g(e,t.pointerId,"pointerId");1&i&&(2!==t.button||"touch"==o)?0>a&&(e.push(t),a=e.length-1):12&i&&(n=!0),0>a||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var kt={touchstart:1,touchmove:2,touchend:4,touchcancel:8};c(j,T,{handler:function(t){var e=kt[t.type];if(1===e&&(this.started=!0),!!this.started){var n=X.call(this,t,e);12&e&&0==n[0].length-n[1].length&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var Dt={touchstart:1,touchmove:2,touchend:4,touchcancel:8};c(z,T,{handler:function(t){var e=Dt[t.type],n=B.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}),c(q,T,{handler:function(t,e,n){var r="touch"==n.pointerType,i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)$.call(this,e,n);else if(i&&U.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Lt=w(ft.style,"touchAction"),Rt=void 0!==Lt,It=function(){if(!Rt)return!1;var e={},n=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(r){e[r]=!n||t.CSS.supports("touch-action",r)}),e}();G.prototype={set:function(t){"compute"==t&&(t=this.compute()),Rt&&this.manager.element.style&&It[t]&&(this.manager.element.style[Lt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return a(this.manager.recognizers,function(e){l(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),V(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var r=this.actions,i=v(r,"none")&&!It.none,o=v(r,"pan-y")&&!It["pan-y"],a=v(r,"pan-x")&&!It["pan-x"];if(i){var s=1===t.pointers.length,c=2>t.distance,u=250>t.deltaTime;if(s&&c&&u)return}return a&&o?void 0:i||o&&6&n||a&&24&n?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};W.prototype={defaults:{},set:function(t){return lt(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(o(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=J(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return o(t,"dropRecognizeWith",this)?this:(t=J(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(o(t,"requireFailure",this))return this;var e=this.requireFail;return t=J(t,this),-1===g(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(o(t,"dropRequireFailure",this))return this;t=J(t,this);var e=g(this.requireFail,t);return-1<e&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,r=this.state;r<8&&e(n.options.event+K(r)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),r>=8&&e(n.options.event+K(r))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=32)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=lt({},t);return l(this.options.enable,[this,e])?(56&this.state&&(this.state=1),this.state=this.process(e),void(30&this.state&&this.tryEmit(e))):(this.reset(),void(this.state=32))},process:function(){},getTouchAction:function(){},reset:function(){}},c(Q,W,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:32}}),c(tt,Q,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:0>o?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?1:0>a?8:16,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Q.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Z(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),c(et,Q,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=1>t.scale?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),c(nt,W,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!o)this.reset();else if(1&t.eventType)this.reset(),this._timer=i(function(){this.state=8,this.tryEmit()},e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8!==this.state||(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=vt(),this.manager.emit(this.options.event,this._input)))}}),c(rt,Q,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),c(it,Q,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return tt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&dt(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Z(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),c(ot,W,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&o&&n){if(4!=t.eventType)return this.failTimeout();var a=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||R(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&a?this.count+=1:this.count=1,this._input=t;if(0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=i(function(){this.state=8,this.tryEmit()},e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=i(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),at.VERSION="2.0.8",at.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[rt,{enable:!1}],[et,{enable:!1},["rotate"]],[it,{direction:6}],[tt,{direction:6},["swipe"]],[ot],[ot,{event:"doubletap",taps:2},["tap"]],[nt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};st.prototype={set:function(t){return lt(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof W)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(o(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(o(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=g(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(void 0!==t&&void 0!==e){var n=this.handlers;return a(m(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(void 0!==t){var n=this.handlers;return a(m(t),function(t){e?n[t]&&n[t].splice(g(n[t],e),1):delete n[t]}),this}},emit:function(t,e){this.options.domEvents&&ut(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&ct(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},lt(at,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:st,Input:T,TouchAction:G,TouchInput:z,MouseInput:N,PointerEventInput:Y,TouchMouseInput:q,SingleTouchInput:j,Recognizer:W,AttrRecognizer:Q,Tap:ot,Pan:tt,Swipe:it,Pinch:et,Rotate:rt,Press:nt,on:f,off:p,each:a,merge:gt,extend:mt,assign:lt,inherit:c,bindFn:u,prefixed:w}),(void 0===t?"undefined"==typeof self?{}:self:t).Hammer=at,"function"==typeof define&&define.amd?define(function(){return at}):void 0!==e&&e.exports?e.exports=at:t.Hammer=at})(window,document),e.exports=Hammer,e.exports._=n}),require("dom.theme",function(t,e,n){function r(t,e){for(var n="",r=1;10>=r;r++)p.forEach(function(i){for(var o=".thm-bg"+i,a=".thm-fg"+i,s=1;s<=r;s++){for(var c=[],u=[],l=[],h=1;h<=r;h++)l.push(s==h?o:"*"),u.push(s==h?o:"*"),c.push(s==h?a:"*"),h==r&&(l.push(l.pop()+".thm-fg"),c.push(c.pop()+a));n+="body.dom-theme-"+t+" "+l.join(" > ")+" { color: "+e["fg"+i]+" }\n",n+="body.dom-theme-"+t+" "+c.join(" > ")+" { color: "+e["bg"+i]+" }\n",n+="body.dom-theme-"+t+" "+u.join(" > ")+" .thm-svg-fill0 { fill: "+e["fg"+i]+" }\n",n+="body.dom-theme-"+t+" "+u.join(" > ")+" .thm-svg-stroke0 { stroke: "+e["fg"+i]+" }\n"}});return n}function i(t,e){var n="body.dom-theme-"+t+"{\n";return p.forEach(function(t){n+="  --thm-bg"+t+": "+e["bg"+t]+";\n"}),n+="}\n"}function o(t,e){var n="";return p.forEach(function(r){n+="body.dom-theme-"+t+".thm-bg"+r+" { background-color: "+e["bg"+r]+" }\n",n+="body.dom-theme-"+t+" .thm-fg"+r+" { color: "+e["fg"+r]+" }\n",n+="body.dom-theme-"+t+" .thm-bg"+r+" { background-color: "+e["bg"+r]+" }\n",n+="body.dom-theme-"+t+" .thm-bg"+r+"-bottom { background: linear-gradient(to top,"+e["bg"+r]+",transparent) }\n",
n+="body.dom-theme-"+t+" .thm-bg"+r+"-top { background: linear-gradient(to bottom,"+e["bg"+r]+",transparent) }\n",n+="body.dom-theme-"+t+" .thm-bg"+r+"-left { background: linear-gradient(to right,"+e["bg"+r]+",transparent) }\n",n+="body.dom-theme-"+t+" .thm-bg"+r+"-right { background: linear-gradient(to left,"+e["bg"+r]+",transparent) }\n",isNaN(parseInt(r))&&(n+="body.dom-theme-"+t+" .thm-svg-fill"+r+" { fill: "+e["bg"+r]+" }\n",n+="body.dom-theme-"+t+" .thm-svg-stroke"+r+" { stroke: "+e["bg"+r]+" }\n")}),n}function a(t,e){var n=f.luminance(e.bg2),r=.6>n?l(e.white,Math.ceil(10*n)):l(e.black,"6"),i="";return[0,1,2,3,4,6,8,9,12,16,24].forEach(function(e){i+="body.dom-theme-"+t+" .thm-ele"+e+" {\n  box-shadow: 0 "+e+"px "+2*e+"px "+r+"\n}\n"}),i}function s(t){return void 0===t&&(t={}),"string"!=typeof t.bg0&&(t.bg0="#E0E0E0"),"string"!=typeof t.bg1&&(t.bg1="#F5F5F5"),"string"!=typeof t.bg2&&(t.bg2="#FAFAFA"),"string"!=typeof t.bg3&&(t.bg3="#FFF"),"string"!=typeof t.bgP&&(t.bgP="#3E50B4"),"string"!=typeof t.bgPD&&(t.bgPD=c(t.bgP)),"string"!=typeof t.bgPL&&(t.bgPL=u(t.bgP)),"string"!=typeof t.bgS&&(t.bgS="#FF3F80"),"string"!=typeof t.bgSD&&(t.bgSD=c(t.bgS)),"string"!=typeof t.bgSL&&(t.bgSL=u(t.bgS)),void 0===t.white&&(t.white="#fff"),void 0===t.black&&(t.black="#000"),p.forEach(function(e){var n=t["bg"+e],r=f.luminance(n);t["fg"+e]=.6>r?t.white:t.black}),t}function c(t){var e=new f(t);return e.rgb2hsl(),e.L*=.75,e.hsl2rgb(),e.stringify()}function u(t){var e=new f(t);return e.rgb2hsl(),e.L=.4+.6*e.L,e.hsl2rgb(),e.stringify()}function l(t,e){return 5>t.length?t+e:t+e+e}var h=function(){function e(){return r(n,arguments)}var n={en:{},fr:{}},r=t("$").intl;return e.all=n,e}();n.register=function(t,e){e=s(e);var n=i(t,e);n+=o(t,e),n+=a(t,e),n+=r(t,e);var c=d.css[t];return c||(c=document.createElement("style"),document.getElementsByTagName("head")[0].appendChild(c),d.css[t]=c),c.textContent=n,this},n.apply=function(t,e){if(void 0===e&&(e=document.body),!d.css[t])return void console.error("This theme has not been registered: ",t);var n=document.body;"string"==typeof d.current&&this.removeClass(n,"dom-theme-"+d.current),d.current=t,this.addClass(n,"dom-theme-"+d.current)};var f=t("tfw.color"),p=["0","1","2","3","P","PD","PL","S","SD","SL"],d={css:{},current:null};e.exports._=h}),require("tfw.color",function(t,e){function n(t){this.R=0,this.G=0,this.B=0,this.A=0,this.H=0,this.S=0,this.L=0,"string"==typeof t&&this.parse(t)}function r(t){if("#"!==t.charAt(0))return!1;var e=0,n=0,r=0,i=1;switch(t.length){case 4:e=parseInt(t.charAt(1),16)*p,n=parseInt(t.charAt(2),16)*p,r=parseInt(t.charAt(3),16)*p;break;case 5:e=parseInt(t.charAt(1),16)*p,n=parseInt(t.charAt(2),16)*p,r=parseInt(t.charAt(3),16)*p,i=parseInt(t.charAt(4),16)*p;break;case 7:e=parseInt(t.substr(1,2),16)*v,n=parseInt(t.substr(3,2),16)*v,r=parseInt(t.substr(5,2),16)*v;break;case 9:e=parseInt(t.substr(1,2),16)*v,n=parseInt(t.substr(3,2),16)*v,r=parseInt(t.substr(5,2),16)*v,i=parseInt(t.substr(7,2),16)*v}return isNaN(e)||isNaN(n)||isNaN(r)||isNaN(i)?this.R=this.G=this.B=this.A=0:(this.R=e,this.G=n,this.B=r,this.A=i),!0}function i(t){var e=g.exec(t);return!!e&&(this.R=c(parseInt(e[1],10)*v),this.G=c(parseInt(e[2],10)*v),this.B=c(parseInt(e[3],10)*v),this.A=1,!0)}function o(t){var e=y.exec(t);return!!e&&(this.R=c(parseInt(e[1],10)*v),this.G=c(parseInt(e[2],10)*v),this.B=c(parseInt(e[3],10)*v),this.A=c(parseFloat(e[4])),!0)}function a(t){var e=b.exec(t);return!!e&&(this.H=c(parseInt(e[1],10)*m),this.S=c(parseInt(e[2],10)*d),this.L=c(parseInt(e[3],10)*d),this.A=1,this.hsl2rgb(),!0)}function s(t){var e=Math.floor(t).toString(16);return 2>e.length&&(e="0"+e),e}function c(t){return 0>t?0:1<t?1:t}function u(t){var e=new n;return e.parse(t),e}var l=function(){function e(){return r(n,arguments)}var n={en:{},fr:{}},r=t("$").intl;return e.all=n,e}();e.exports=n,n.prototype.luminance=function(){return.2126*this.R+.7152*this.G+.0722*this.B},n.prototype.stringify=function(){var t=s(255*this.R)+s(255*this.G)+s(255*this.B);return 1>this.A&&(t+=s(255*this.A)),"#".concat(t)},n.prototype.parse=function(t){var e=void 0===t?"#000000":t,n=e.trim().toUpperCase();return!!(r.call(this,n)||i.call(this,n)||o.call(this,n)||a.call(this,n))},n.prototype.copy=function(){var t=new n;return t.R=this.R,t.G=this.G,t.B=this.B,t.A=this.A,t.H=this.H,t.S=this.S,t.L=this.L,t},n.prototype.hsl2rgb=function(){var t=6*this.H,e=this.S,n=this.L,r=(1-Math.abs(2*n-1))*e,i=r*(1-Math.abs(t%2-1)),o=0,a=0,s=0;3>t?1>t?(o=r,a=i,s=0):2>t?(o=i,a=r,s=0):(o=0,a=r,s=i):4>t?(o=0,a=i,s=r):5>t?(o=i,a=0,s=r):(o=r,a=0,s=i);var c=n-.5*r;this.R=o+c,this.G=a+c,this.B=s+c},n.prototype.rgb2hsl=function(){var t=this.R,e=this.G,n=this.B,r=Math.min(t,e,n),i=Math.max(t,e,n),o=i-r;this.L=.5*(i+r),1e-6>o?(this.H=0,this.S=0):(this.S=o/(1-Math.abs(2*this.L-1)),this.H=i===t?e>=n?f*((e-n)/o):1-f*((n-e)/o):i===e?f*(2+(n-t)/o):f*(4+(t-e)/o))};var h=new n;n.instance=h,n.parse=u,n.luminance=function(t){return u(t).luminance()},n.newRGB=function(t){var e=new n;return e.R=t,e.G=t,e.B=t,e},n.newRGBA=function(t){var e=new n;return e.R=t,e.G=t,e.B=t,e.A=t,e};var f=1/6,p=1/15,d=1/99,v=1/255,m=1/359,g=/^RGB[\s\(]+([0-9]+)[^0-9]+([0-9]+)[^0-9]+([0-9]+)/,y=/^RGBA[\s\(]+([0-9]+)[^0-9]+([0-9]+)[^0-9]+([0-9]+)[^0-9\.]+([0-9\.]+)/,b=/^HSL[\s\(]+([0-9]+)[^0-9]+([0-9]+)[^0-9]+([0-9]+)/;e.exports._=l}),require("polyfill.classList",function(t,e){var n=function(){function e(){return r(n,arguments)}var n={en:{}},r=t("$").intl;return e.all=n,e}();"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?function(){var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,r=arguments.length;for(n=0;n<r;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}t=null}():function(t){if("Element"in t){var e=t.Element.prototype,n=Object,r=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},i=Array.prototype.indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},o=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new o("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new o("INVALID_CHARACTER_ERR","String contains an invalid character");return i.call(t,e)},s=function(t){for(var e=r.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,o=n.length;i<o;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},c=s.prototype=[],u=function(){return new s(this)};if(o.prototype=Error.prototype,c.item=function(t){return this[t]||null},c.contains=function(t){return t+="",-1!==a(this,t)},c.add=function(){var t,e=arguments,n=0,r=e.length,i=!1;do{t=e[n]+"",-1===a(this,t)&&(this.push(t),i=!0)}while(++n<r);i&&this._updateClassName()},c.remove=function(){var t,e,n=arguments,r=0,i=n.length,o=!1;do{for(t=n[r]+"",e=a(this,t);-1!==e;)this.splice(e,1),o=!0,e=a(this,t)}while(++r<i);o&&this._updateClassName()},c.toggle=function(t,e){t+="";var n=this.contains(t),r=n?!0!==e&&"remove":!1!==e&&"add";return r&&this[r](t),!0===e||!1===e?e:!n},c.toString=function(){return this.join(" ")},n.defineProperty){var l={get:u,enumerable:!0,configurable:!0};try{n.defineProperty(e,"classList",l)}catch(t){-2146823252===t.number&&(l.enumerable=!1,n.defineProperty(e,"classList",l))}}else n.prototype.__defineGetter__&&e.__defineGetter__("classList",u)}}(self)),e.exports._=n});
//# sourceMappingURL=s5.html.map