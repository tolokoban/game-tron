"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}require("s3.car",function(require,module){var Polyline=require("s3.polyline"),_require=require("common"),readonly=_require.readonly,IDX_X=0,IDX_Y=1,MINUS_ONE=-1,DIRECTIONS=[[0,MINUS_ONE],[1,0],[0,1],[MINUS_ONE,0]],NB_DIRS=DIRECTIONS.length,RIGHT=1,LEFT=3,Car=function(){function Car(_ref){var action=_ref.action,_ref$x=_ref.x,x=void 0===_ref$x?0:_ref$x,_ref$y=_ref.y,y=void 0===_ref$y?256:_ref$y,_ref$dir=_ref.dir,dir=void 0===_ref$dir?RIGHT:_ref$dir,_ref$color=_ref.color,color=void 0===_ref$color?"cyan":_ref$color,_ref$minSpeed=_ref.minSpeed,minSpeed=void 0===_ref$minSpeed?.05:_ref$minSpeed,_ref$maxSpeed=_ref.maxSpeed,maxSpeed=void 0===_ref$maxSpeed?.25:_ref$maxSpeed,_ref$breakPower=_ref.breakPower,breakPower=void 0===_ref$breakPower?5e-4:_ref$breakPower;_classCallCheck(this,Car);var that=this;this.action=action,this.speed=minSpeed,this.lastTime=0,this.dir=dir,readonly(this,{minSpeed:minSpeed,maxSpeed:maxSpeed,breakPower:breakPower,color:color,polyline:new Polyline(x,y),dirRight:function dirRight(){return(that.dir+RIGHT)%NB_DIRS},dirLeft:function dirLeft(){return(that.dir+LEFT)%NB_DIRS},vx:function vx(){return DIRECTIONS[that.dir][IDX_X]},vy:function vy(){return DIRECTIONS[that.dir][IDX_Y]},vxRight:function vxRight(){return DIRECTIONS[that.dirRight][IDX_X]},vyRight:function vyRight(){return DIRECTIONS[that.dirRight][IDX_Y]},vxLeft:function vxLeft(){return DIRECTIONS[that.dirLeft][IDX_X]},vyLeft:function vyLeft(){return DIRECTIONS[that.dirLeft][IDX_Y]}})}return _createClass(Car,[{key:"move",value:function move(time){if(0===this.lastTime)return void(this.lastTime=time);var delta=time-this.lastTime;this.lastTime=time,this.action.process(time,delta),this.speed>this.minSpeed&&(this.speed=Math.max(this.minSpeed,this.speed-this.breakPower*delta));var action=this.action;action.actionRight?(this.polyline.add(),this.dir=(this.dir+RIGHT)%DIRECTIONS.length):action.actionLeft&&(this.polyline.add(),this.dir=(this.dir+LEFT)%DIRECTIONS.length),action.actionAccel&&(this.speed=this.maxSpeed);var dirV=DIRECTIONS[this.dir],vx=this.speed*delta*dirV[0],vy=this.speed*delta*dirV[1];this.polyline.move(vx,vy)}}]),Car}();module.exports=Car,module.exports._=function _(){return""}});