"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)descriptor=props[i],descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}require("s3.polyline",function(require,module){function collideVertical(x,_y0,_y1){if(_y0===_y1)return!1;for(var arr=this._arr,idx=(this._start+2)%this._capacity,offset=this.firstX===arr[idx]?2:0,y0=Math.min(_y0,_y1),y1=Math.max(_y0,_y1),k=offset;k<this._length;k+=4){var idx0=(k+this._start)%this._length,xx0=arr[idx0],yy=arr[idx0+1],idx1=(idx0+2)%this._length,xx1=arr[idx1];if(xx0===xx1)break;var xMin=Math.min(xx0,xx1),xMax=Math.max(xx0,xx1);if(!(x<=xMin||x>=xMax)&&!(yy<y0||yy>y1))return!0}return!1}function collideHorizontal(y,_x0,_x1){if(_x0===_x1)return!1;for(var arr=this._arr,idx=(this._start+2+1)%this._capacity,offset=this.firstY===arr[idx]?2:0,x0=Math.min(_x0,_x1),x1=Math.max(_x0,_x1),k=offset;k<this._length;k+=4){var idx0=(k+this._start)%this._length,yy0=arr[idx0+1],xx=arr[idx0],idx1=(idx0+2)%this._length,yy1=arr[idx1+1];if(yy0===yy1)break;var yMin=Math.min(yy0,yy1),yMax=Math.max(yy0,yy1);if(!(y<=yMin||y>=yMax)&&!(xx<x0||xx>x1))return!0}return!1}var _require=require("common"),readonly=_require.readonly,DIM2=2,Polyline=function(){function Polyline(x,y){var capacity=2<arguments.length&&void 0!==arguments[2]?arguments[2]:128;_classCallCheck(this,Polyline);var arr=new Float32Array(capacity<<1);arr[0]=x,arr[1]=y,arr[2]=x,arr[3]=y,this._arr=arr,this._start=0,this._length=DIM2<<1,this._capacity=capacity<<1,readonly(this,{length:function length(){return this._length>>1},firstX:function firstX(){return this._arr[this._start]},firstY:function firstY(){return this._arr[this._start+1]},lastX:function lastX(){return this._arr[(this._start+this._length-DIM2)%this._capacity]},lastY:function lastY(){return this._arr[(this._start+this._length-DIM2+1)%this._capacity]}})}return _createClass(Polyline,[{key:"foreachTail",value:function foreachTail(callback){for(var index,arr=this._arr,k=DIM2;k<this._length;k+=DIM2)index=(k+this._start)%this._length,callback(arr[index],arr[index+1])}},{key:"move",value:function move(dx,dy){var index=(this._start+this._length-DIM2)%this._capacity;this._arr[index]+=dx,this._arr[index+1]+=dy}},{key:"add",value:function add(){var index=(this._start+this._length-DIM2)%this._capacity,arr=this._arr,x=arr[index],y=arr[index+1];if(this._length<this._capacity){var nextIdx=(index+DIM2)%this._capacity;arr[nextIdx]=x,arr[nextIdx+1]=y,this._length+=DIM2}else{var startIdx=this._start;arr[startIdx]=x,arr[startIdx+1]=y,this._start=(this._start+DIM2)%this._capacity}}},{key:"collide",value:function collide(x0,y0,x1,y1){return x0===x1?collideVertical.call(this,x0,y0,y1):collideHorizontal.call(this,y0,x0,x1)}}]),Polyline}();module.exports=Polyline,module.exports._=function _(){return""}});